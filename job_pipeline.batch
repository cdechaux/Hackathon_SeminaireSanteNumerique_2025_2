#!/bin/bash
#SBATCH --job-name=pipeline_ssn
#SBATCH --partition=gpu
#SBATCH --gres=gpu:1 # évite les 1080 Ti ; sinon: --gres=gpu:1 --exclude=gpu004
#SBATCH --constraint="h100|a100|v100"
#SBATCH -c 8
#SBATCH --mem=40G
#SBATCH --time=03:00:00           # mets une marge confortable
#SBATCH --output=logs/%x_%j.out


# --- Préparation simple ---
mkdir -p logs
cd /home/cdechaux/cleps-examples/mpi/Hackathon_SeminaireSanteNumerique_2025_2

# Active ton environnement (au choix : conda OU venv)
# --- Option A : conda ---
#source ~/miniconda3/etc/profile.d/conda.sh
#conda activate pt_env

# --- Option B : venv ---
python -m venv aoc-env
source .venv/bin/activate
pip install -r requirements.txt

# --- Lancement ---
python run_pipeline.py \
  --input-csv dp_dataset.csv \
  --output-csv pred.csv \
  --mode predict \
  --backend llm