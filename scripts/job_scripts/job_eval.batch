#!/bin/bash
#SBATCH --job-name=eval_ssn
#SBATCH --partition=gpu
#SBATCH --gres=gpu:1 # évite les 1080 Ti ; sinon: --gres=gpu:1 --exclude=gpu004

#SBATCH -c 8
#SBATCH --mem=40G
#SBATCH --time=03:00:00           
#SBATCH --output=logs/%x_%j.out


# --- Préparation ---
mkdir -p logs


# Activer environnement (au choix : conda OU venv)
# --- Option A : conda ---
source ~/miniconda3/etc/profile.d/conda.sh
conda activate pt_env

# --- Option B : venv ---
#python -m venv aoc-env
#source .venv/bin/activate


pip install -r requirements.txt

# --- Lancement ---
python scripts/eval_dp.py \
  --gold-csv data/dp_dataset_small.csv --gold-id code_sejour --gold-col code_dp \
  --pred-csv data/pred_simple.csv       --pred-id code_sejour --pred-col dp_predit \
  --average macro